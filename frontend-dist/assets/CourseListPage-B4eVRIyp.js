import{a as N,u as w,r,j as e}from"./index-C-rJlfSu.js";import{s as h}from"./supabase-CEO_BhdU.js";function _(){const{assessor:g,logout:p}=N(),o=w(),[n,y]=r.useState([]),[j,i]=r.useState(!0),[d,l]=r.useState(""),[a,c]=r.useState(new Date().toISOString().split("T")[0]),m=r.useCallback(async()=>{i(!0),l("");try{const{data:s,error:t}=await h.from("courses").select(`
          *,
          template:course_templates(*)
        `).eq("course_date",a).order("course_name",{ascending:!0});if(t)throw t;const f=await Promise.all((s||[]).map(async x=>{const{count:v}=await h.from("participants").select("*",{count:"exact",head:!0}).eq("course_id",x.course_id);return{...x,participant_count:v||0}}));y(f)}catch(s){console.error("Error loading courses:",s),l("Failed to load courses. Please try again.")}finally{i(!1)}},[a]);r.useEffect(()=>{m()},[m]);const b=()=>{p(),o("/login")},u=s=>{o(`/course/${s}/participants`)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b-2 border-redi-coral",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-redi-navy",children:"REdI Assessment System"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Welcome, ",g?.name]})]}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-redi-navy hover:bg-redi-navy-light text-white rounded-lg transition-colors duration-200",children:"Logout"})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-redi-navy mb-4",children:"Select Course"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("label",{htmlFor:"course-date",className:"text-sm font-medium text-gray-700",children:"Course Date:"}),e.jsx("input",{id:"course-date",type:"date",value:a,onChange:s=>c(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-redi-teal focus:border-transparent"}),e.jsx("button",{onClick:()=>c(new Date().toISOString().split("T")[0]),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition-colors duration-200",children:"Today"})]})]}),d&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:d}),j?e.jsx("div",{className:"flex justify-center items-center py-12",role:"status","aria-label":"Loading",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-redi-teal","aria-hidden":"true"})}):n.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-redi-navy mb-2",children:"No courses found"}),e.jsxs("p",{className:"text-gray-600",children:["No courses scheduled for ",new Date(a).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>u(s.course_id),onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),u(s.course_id))},className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow duration-200 cursor-pointer overflow-hidden border-l-4 border-redi-teal focus:outline-none focus:ring-2 focus:ring-redi-teal focus:ring-offset-2",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-redi-navy flex-1",children:s.course_name}),e.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-medium bg-redi-light-teal/30 text-redi-navy rounded",children:s.template?.course_type.replace("_"," ")})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(s.course_date).toLocaleDateString("en-AU",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]}),s.course_coordinator&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),s.course_coordinator]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.participant_count," participant",s.participant_count!==1?"s":""]})]})]}),e.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-100 flex justify-between",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),o(`/course/${s.course_id}/dashboard`)},className:"text-sm font-medium text-redi-teal hover:text-redi-teal-dark",children:"Dashboard →"}),e.jsx("button",{className:"text-sm font-medium text-redi-coral hover:text-redi-coral-dark",children:"Participants →"})]})]},s.course_id))})]})]})}export{_ as default};
